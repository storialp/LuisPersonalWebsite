---
import { type CollectionEntry, getCollection } from 'astro:content';
import mainLayout from '../../layouts/mainLayout.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}
type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await post.render();
---

<mainLayout>
	<article style={{ maxWidth: '720px', margin: '0 auto', padding: '120px 2rem 4rem' }}>
		<header style={{ marginBottom: '3rem' }}>
			<a
				href="/blog"
				style={{
					display: 'inline-flex',
					alignItems: 'center',
					gap: '0.5rem',
					color: 'var(--text-muted)',
					textDecoration: 'none',
					fontSize: '0.85rem',
					marginBottom: '2rem',
					transition: 'color 0.2s',
				}}
				onMouseOver={(e) => (e.currentTarget.style.color = 'var(--accent)')}
				onMouseOut={(e) => (e.currentTarget.style.color = 'var(--text-muted)')}
			>
				<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M19 12H5M12 19l-7-7 7-7" />
				</svg>
				Back to blog
			</a>
			<time datetime={post.data.pubDate.toISOString()} style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>
				{post.data.pubDate.toLocaleDateString('en-us', {
					year: 'numeric',
					month: 'long',
					day: 'numeric',
				})}
			</time>
			<h1 style={{ fontSize: '2rem', fontWeight: '600', marginTop: '0.5rem', lineHeight: '1.2' }}>
				{post.data.title}
			</h1>
			{post.data.description && (
				<p style={{ color: 'var(--text-muted)', marginTop: '1rem', fontSize: '1.1rem' }}>
					{post.data.description}
				</p>
			)}
		</header>
		<div class="prose" style={{ lineHeight: '1.7', fontSize: '1rem' }}>
			<Content />
		</div>
	</article>
</mainLayout>

<style is:global>
	.prose h1,
	.prose h2,
	.prose h3,
	.prose h4 {
		color: var(--text);
		font-weight: 600;
		margin-top: 2rem;
		margin-bottom: 1rem;
	}
	.prose h2 { font-size: 1.5rem; }
	.prose h3 { font-size: 1.25rem; }
	.prose p {
		margin-bottom: 1.25rem;
		color: var(--text);
	}
	.prose ul,
	.prose ol {
		margin-bottom: 1.25rem;
		padding-left: 1.5rem;
		color: var(--text);
	}
	.prose li {
		margin-bottom: 0.5rem;
	}
	.prose a {
		color: var(--accent);
		text-decoration: underline;
		text-underline-offset: 2px;
	}
	.prose a:hover {
		text-decoration: none;
	}
	.prose code {
		background: var(--bg-card);
		padding: 0.2rem 0.4rem;
		border-radius: 4px;
		font-size: 0.9em;
	}
	.prose pre {
		background: var(--bg-secondary);
		padding: 1rem;
		border-radius: 8px;
		overflow-x: auto;
		margin-bottom: 1.25rem;
	}
	.prose pre code {
		background: none;
		padding: 0;
	}
	.prose blockquote {
		border-left: 3px solid var(--accent);
		padding-left: 1rem;
		margin: 1.5rem 0;
		color: var(--text-muted);
		font-style: italic;
	}
	.prose img {
		max-width: 100%;
		border-radius: 8px;
		margin: 1.5rem 0;
	}
	.prose hr {
		border: none;
		borderTop: '1px solid var(--border)';
		margin: 2rem 0;
	}
</style>
